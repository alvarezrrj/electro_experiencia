// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  previewFeatures = ["fullTextSearch", "fullTextIndex"]
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id              Int         @id             // DNI
  first_name      String
  last_name       String
  email           String      @unique
  password        String      @db.VarChar(64) // 256 bits in hex
  gender          String
  username        String      @unique
  cuit            String      @unique @db.VarChar(32)
  condicion_iva   String      @default("Consumidor final")
  rol             Int     
  Rol             Rol         @relation(fields: [rol], references: [id_rol])
  Recepciones     Recepcion[]
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt

  @@map("usuarios")
}

model Rol {
  id_rol          Int         @id @default(autoincrement())
  descripcion     String      @unique
  usuarios        Usuario[]  
  createdAt       DateTime    @default(now())
  updatedAt       DateTime?   @updatedAt

  @@map("roles")
}

model ReparacionNomenclada {
  id                Int         @id @default(autoincrement())
  name              String      @unique
  descripcion       String      @db.Text      // 65,535
  createdAt         DateTime    @default(now())
  updatedAt         DateTime?   @updatedAt

  @@fulltext([name, descripcion])
  @@map("reparaciones_nomencladas")
}

model Recepcion {
  id                Int         @id @default(autoincrement())
  first_name        String
  last_name         String
  email             String      @unique
  telefono          String      @db.VarChar(15)
  equipo            String
  // TODO agregar tipo (tipo de equipo)
  descripcion       String      @db.Text      // 65,535
  employee_id       Int         
  Employee          Usuario     @relation(fields: [employee_id], references: [id])
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt

  @@map("recepciones")
}